---
title: "Google Analyticsやリスティング広告の「タグ」の仕組みとは？"
emoji: "📝"
type: "idea"
topics: ["基礎"]
published: true
published_at: 2020-01-29
---

:::message
この記事は、2020-01-29に別のブログ媒体に投稿した記事のアーカイブです。
:::

こんにちは、たつきちです。

ブログやWebサイトの運営、リスティング広告などのWeb広告の運用をしている方にとっては、「サイトにタグを設置する」という行為は馴染み深いものだと思います。

ですが、この「タグ」の仕組みをちゃんと理解して使っている人は案外少ないように思います。

理解していなくても設置して運用することはできると思いますが、雰囲気で使っているといざ何かトラブルがあったときに自力で対処できなくて困ることもありますよね。

というわけで、今回はWebサイトに設置する「タグ」というものについて学んでみましょう！

# タグ

世の中には、既存のWebページに特殊な機能を追加してくれるタイプのWebサービスがあります。

例えば、

* Webサイト内の各ページに、いつ、どれぐらいの、どんな性質のユーザーが訪れたかを記録し、分析できるようにしてくれる
* リスティング広告の機能の一つとして、Webサイト内のあるページが表示されたときに、条件が揃っていればリスティング広告の「コンバージョン」として計測してくれる

といったものです。

これらのサービスを利用するには、サービス側から提供されている **短いHTMLコード** を、WebページのHTML内にあらかじめ貼り付けておく必要がある。

このような短いHTMLコードのことを、俗に **タグ** と呼びます。（まったく厳密な用語ではなく、俗称です。単にHTMLタグを指して「タグ」と呼ぶことも多いので、混同しないよう注意が必要ですね）

## タグの仕組み

タグの正体は、ほとんどの場合は下記のような **JavaScriptの小さなプログラム** （を実行させるためのHTMLコード）です。

```
<script type="text/javascript>
// JavaScriptの処理がここに書かれている
</script>
```

タグが設置されているWebページにユーザーがアクセスすると、自動的にタグに書かれている処理が実行されて、サービス側に必要な情報が送られる、という流れが一般的です。

> タグの種類によっては、ただページにアクセスしただけでは何も起こらず、指定されたボタンなどがクリックされたときに初めて何かの処理が実行される、とような場合もあります。

# コンバージョンタグ（CVタグ）

Web広告の運用者が最もよく扱うタグといえば、コンバージョンタグでしょう。

**コンバージョン扱いとしたいページ（お申し込み完了ページなど）** にタグを設置しておけば、広告経由のユーザーがそのページを開いた場合のみ、コンバージョンとして計測してくれるという代物です。

コンバージョンタグは、基本的に広告媒体の管理画面上で発行することができます。

# Google Analyticsタグ（アナリティクスタグ、GAタグ）

Google Analyticsは、Googleが提供するアクセス解析サービスです。

アクセス解析サービスのデファクトスタンダードとなっており、Google Analyticsを指して単に「アナリティクス」と呼ぶことも多いですね。

**Webサイトの全ページに** タグを設置しておけば、WebサイトへのアクセスをすべてGoogle Analyticsが記録してくれ、Google Analyticsの管理画面でアクセスの内容や傾向を詳細に分析することができます。

GAタグは、Google Analyticsの管理画面上で発行できます。

# タグマネージャー

昨今では、Webサイトに複数のWebサービスのタグを設置することも珍しくありません。（GAタグ、Yahoo!広告のCVタグ、Google広告のCVタグ、だけでも3種類になります）

後から別のサービスのタグを追加したり、設置済みのタグを何かの事情で差し替えたり削除したりしたい場合には、当然ながらその都度WebサイトのHTMLソースコードを修正する必要があるため、かなりの手間になります。

このような問題を解決するために、 **タグマネージャー** と呼ばれるサービスが存在します。

タグマネージャーは、各種Webサービスのタグを一元管理するためのサービスです。

例えば、タグマネージャーの管理画面で **「タグマネージャーのタグ」** を1つ発行して、それを **Webサイトの全ページ** に設置しておけば、タグマネージャーの管理画面上で各種Webサービスのタグを追加したり削除したり編集したりといった操作ができるようになります。

各種タグの追加や変更を行う場合にWebページのHTMLに手を加える必要はなく、タグマネージャーの管理画面を操作するだけでよくなるわけです。

タグマネージャーサービスとしては「Googleタグマネージャー」と「Yahoo!タグマネージャー」が二大巨塔です。

## タグマネージャーでのCVタグの設定

タグマネージャーのタグは、基本的にWebサイトの全ページに設置します。

でも、CVタグの場合は、 **CVページ以外では動作してほしくない** ですよね。

そこで、タグマネージャーの管理画面では、タグごとに「このURLのときだけ動作させる」といった設定ができるようになっています。

また、一部のWebサイトでは、例えば **「お申し込みフォーム」の画面と「お申し込み完了」の画面とでURLが変わらない** というような場合があったりします。（いわゆるAjaxでフォームを送信するタイプのWebサイトですね）

このような場合のために、「フォームの送信ボタンがクリックされたらCVタグを動作させる」といった設定もできるようになっています。

この場合、 `id` や `class` などを使ってクリック対象のDOM要素を指定するといった少し複雑な設定が必要となります。

> 「DOM要素」「 `id` 」「 `class` 」等については [こちらの記事](https://zenn.dev/ttskch/articles/69c8553acbc68c) で詳しく説明していますので、参考にしてみてください。

# まとめ

* Webサービスの「タグ」の正体は、ほとんどの場合は **JavaScriptの小さなプログラム** （を実行させるためのHTMLコード）
* 「タグ」はWebサービスの管理画面上で発行できる
* 「タグマネージャー」というサービスを使うと、複数の「タグ」を一元管理できて便利
* 「タグマネージャー」でコンバージョンタグを管理する場合は、「URLを指定」したり、「DOM要素のクリックイベント」を指定したりといった設定が必要
